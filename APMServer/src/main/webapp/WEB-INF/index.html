<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>APMServer</title>
    <script src="jquery.min.js"></script>

    <script>
        function clearServer() {
            $.get('http://localhost:8888/clear').success(function (response) {
                location.reload();
            }).error(function (response) {
            });
        }

        var level = 0;

        function drawTrace(response) {
            level ++;
            for (var i = 0, len = response.length; i < len; i++) {
                if (response[i].parentSpanId == 0) {
                    $("#content").html($("#content").html() + "</br></br>");
                    $("#content").html($("#content").html() + response[i].operationName + "</br>");
                } else {
                    var levelStr = "";
                    for (var n = 0; n < level; n++) {
                        levelStr = levelStr + "---";
                    }
                    $("#content").html($("#content").html() + levelStr + ">" + response[i].operationName + "</br>");
                }

                if (response[i].children) {
                    drawTrace(response[i].children);
                }
            }
            level --;
        }

        $.get('http://localhost:8888/getData').success(function (response) {
            if (response) {
                drawTrace(JSON.parse(response));
                //alert(response);
            }
        }).error(function (response) {
        });
    </script>

</head>
<body>
<input type="button" value="清除数据" style="width: 200px;height: 30px" onclick="clearServer()"/>
<div id="content" style="height: 100%;width: 100%"></div>
</body>
</html>